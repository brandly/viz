(function(){var t,e,n,i,r,a;a=window,r=a.requestAnimationFrame||a.mozRequestAnimationFrame||a.webkitRequestAnimationFrame||a.oRequestAnimationFrame,t=window.AudioContext||window.webkitAudioContext,i=function(){},e=function(){function t(t){this.setFunction(t)}return t.prototype.request=null,t.prototype.setFunction=function(t){return this.fn=function(e){return function(){return t(),e.start()}}(this)},t.prototype.start=function(){return this.request=r(this.fn)},t.prototype.stop=function(){return this.request?(a.cancelAnimationFrame(this.request),this.request=null):void 0},t}(),n=function(){function n(e,n){var i,r,a,s,o;if(this.id=e,this.frequency=n.frequency,this.time=n.time,this.element=document.getElementById(this.id),!this.element)throw'No element found with id "'+e+'"';if(i=this.element.getElementsByTagName("audio"),!i.length)throw"No <audio> element found inside #"+e;if(this.audio=i[0],s=this.element.getElementsByTagName("canvas"),!s.length)throw"No <canvas> element found inside #"+e;this.canvas=s[0],this.canvasContext=this.canvas.getContext("2d"),r=new t,this.analyser=r.createAnalyser(),o=r.createMediaElementSource(this.audio),o.connect(this.analyser),this.analyser.connect(r.destination),this.audio.addEventListener("play",this.start.bind(this),!1),a=this.stop.bind(this),this.audio.addEventListener("pause",a,!1),this.audio.addEventListener("ended",a,!1)}return n.prototype.repeater=new e,n.prototype.start=function(){var t,e;return t=function(t){return function(){var e;return e=new Uint8Array(t.analyser.frequencyBinCount),t.analyser.getByteFrequencyData(e),t.frequency(e,t.canvasContext,t.canvas)}}(this),e=function(t){return function(){var e;return e=new Uint8Array(t.analyser.frequencyBinCount),t.analyser.getByteTimeDomainData(e),t.time(e,t.canvasContext,t.canvas)}}(this),this.frequency||(t=i),this.time||(e=i),this.repeater.setFunction(function(n){return function(){return n.canvas.width=n.canvas.width,t(),e()}}(this)),this.repeater.start()},n.prototype.stop=function(){return this.repeater.stop()},n}(),window.Viz=n}).call(this);